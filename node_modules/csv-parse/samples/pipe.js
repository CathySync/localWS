
// The package "stream-transform" must be installed:   
// `npm install stream-transform`

var fs = require('fs');
var parse = require('..');
var transform = require('stream-transform');

var parser = parse({delimiter: ',', skip_empty_lines: false})
var input = fs.createReadStream('C:\\Users\\ajon0002\\Documents\\NetBeansProjects\\localWS\\uploads\\data\\demo_duplicate_data.csv');
var transformer = transform(function(record, callback){
  setTimeout(function(){
    callback(null, record.join(' ')+'\n');
  }, 500);
}, {parallel: 10});
input.pipe(parser).pipe(transformer).pipe(process.stdout);

